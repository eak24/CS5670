<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
  "http://www.w3.org/TR/html4/loose.dtd">

<html lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta name="Author" content="Michalis Kamburelis">

<meta name="Language" content="English">

<title>VRML 1.0 (old) extensions</title>


<!--
  This is unclean, but it's more comfortable to keep below CSS
  directly inside HTML page. This is in kambi_common.php,
  that should be useful for both michalis.ii and castle-engine.sf.net webpages,
  and must be suitable also for offline documentation in castle-engine programs.
-->
<!-- link type="text/css" rel="stylesheet" media="all"  href="kambi-php-lib/kambi_common.css" -->

<style type="text/css"><!--
body { background: white; font-family: sans-serif; }

dt { font-weight: bold; }
div.page_footer { }
span.page_copyright { font-size: smaller }

span.version_number { font-size: small }

div.quick_links_bottom_line { text-align: left; }

.rss_link {
  float: right;
  background: red;
  padding: 0.3em;
  border: thin outset black;
}

.rss_link a {
  color: white;
  font-weight: bold
}
--></style>


<link rel="alternate" type="application/rss+xml"
  title="Castle Game Engine - News Feed"
  href="http://castle-engine.sourceforge.net/news_feed.php">

<link type="text/css" rel="stylesheet" media="all" href="castle-engine.css">
<link type="text/css" rel="stylesheet" href="colorbox/example3/colorbox.css">


<script type="text/javascript" src="castle-engine.js"></script>
<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="colorbox/jquery.colorbox-min.js"></script>

<style type="text/css"><!--
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for delphi
 * CSS class: sourcecode, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.delphi.sourcecode .de1, .delphi.sourcecode .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;}
.delphi.sourcecode  {font-family:monospace;}
.delphi.sourcecode .imp {font-weight: bold; color: red;}
.delphi.sourcecode li, .delphi.sourcecode .li1 {font-weight: normal; vertical-align:top;}
.delphi.sourcecode .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.delphi.sourcecode .li2 {font-weight: bold; vertical-align:top;}
.delphi.sourcecode .kw1 {color: #000000; font-weight: bold;}
.delphi.sourcecode .kw2 {color: #000000; font-weight: bold;}
.delphi.sourcecode .kw3 {color: #000066;}
.delphi.sourcecode .kw4 {color: #000066; font-weight: bold;}
.delphi.sourcecode .co1 {color: #808080; font-style: italic;}
.delphi.sourcecode .co2 {color: #008000; font-style: italic;}
.delphi.sourcecode .coMULTI {color: #808080; font-style: italic;}
.delphi.sourcecode .es0 {color: #ff0000; font-weight: bold;}
.delphi.sourcecode .br0 {color: #000066;}
.delphi.sourcecode .sy0 {color: #000066;}
.delphi.sourcecode .sy1 {color: #000066;}
.delphi.sourcecode .sy2 {color: #000066;}
.delphi.sourcecode .sy3 {color: #000066;}
.delphi.sourcecode .st0 {color: #ff0000;}
.delphi.sourcecode .nu0 {color: #0000ff;}
.delphi.sourcecode .me1 {color: #006600;}
.delphi.sourcecode .re0 {color: #0000cc;}
.delphi.sourcecode .re1 {color: #ff0000;}
.delphi.sourcecode .ln-xtra, .delphi.sourcecode li.ln-xtra, .delphi.sourcecode div.ln-xtra {background-color: #ffc;}
.delphi.sourcecode span.xtra { display:block; }
 -->
</style>

<script type="text/javascript">
/* <![CDATA[ */
    (function() {
        var s = document.createElement('script'), t = document.getElementsByTagName('script')[0];
        s.type = 'text/javascript';
        s.async = true;
        s.src = 'http://api.flattr.com/js/0.6/load.js?mode=auto';
        t.parentNode.insertBefore(s, t);
    })();
/* ]]> */
</script><script src="https://apis.google.com/js/platform.js" async defer></script>
  </head>
<body>


  <div class="header">
    <!--img class="header_icon" src="images/header_icon.png" alt="Castle Game Engine icon" /-->
    <div class="google-search-container">
<script>
  (function() {
    var cx = '012479576662529301542:be-myf53lua';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<div class="gcse-search" data-enableAutoComplete="true"></div>
</div>
    <div class="header_title"><a href="http://castle-engine.sourceforge.net/index.php">Castle Game Engine</a></div>
    
    <table class="header_menu">
      <tr>
        <td colspan="15" class="higher higher_left">&larr; Users</td>
        <td colspan="6" class="higher higher_right">Developers &rarr;</td>
      </tr>
      <tr><td class="lower_separator"><div>&nbsp;</div></td><td class="lower"><a href="http://castle-engine.sourceforge.net/index.php">Intro</a></td><td class="lower_separator"><div>&nbsp;</div></td><td class="lower"><a href="http://castle-engine.sourceforge.net/news.php">News</a></td><td class="lower_separator"><div>&nbsp;</div></td><td class="lower"><a href="view3dscene.html" title="VRML / X3D browser, and a viewer for other 3D model formats">view3dscene</a></td><td class="lower_separator"><div>&nbsp;</div></td><td class="lower"><a href="http://castle-engine.sourceforge.net/castle.php" title="First-person perspective game, in a dark fantasy setting">The Castle</a></td><td class="lower_separator"><div>&nbsp;</div></td><td class="lower"><a href="http://castle-engine.sourceforge.net/all_programs.php" title="All the games and tools using our 3D engine">All Programs</a></td><td class="lower_separator"><div>&nbsp;</div></td><td class="lower"><a href="http://castle-engine.sourceforge.net/forum.php" title="Ask for help, report bugs, discuss features">Forum</a></td><td class="lower_separator"><div>&nbsp;</div></td><td class="lower"><a href="http://castle-engine.sourceforge.net/donate.php">Donate</a></td><td class="lower_separator"><div>&nbsp;</div></td><td class="lower"><a href="http://castle-engine.sourceforge.net/engine.php" title="Sources and documentation for developers">Engine</a></td><td class="lower_separator"><div>&nbsp;</div></td><td class="lower"><a href="vrml_x3d.html" title="Our extensions and status of VRML/X3D implementation" id="current">VRML/X3D</a></td><td class="lower_separator"><div>&nbsp;</div></td><td class="lower"><a href="http://castle-engine.sourceforge.net/blender.php" title="Customized Blender X3D exporter">Blender</a></td><td class="lower_separator"><div>&nbsp;</div></td>
      </tr>
    </table>
  </div><table class="layout" cellspacing="0">
      <col class="content_column">
      <col class="sidebar_column">
      <tr><td class="layout content"><div class="header_breadcrumbs"><a href="http://castle-engine.sourceforge.net/index.php">Home <i>(online docs)</i></a> &#187; <a href="vrml_x3d.html">VRML / X3D support</a> &#187; <a href="x3d_extensions.html">Extensions</a></div>
<h1>VRML 1.0 (old) extensions</h1>
<p>Contents:
<div class="table_of_contents"><ol>
<li><a href="#section_ext_global">Lights can be global</a>
</li>
<li><a href="#section_ext_light_attenuation">Lights have <tt>attenuation</tt></a>
</li>
<li><a href="#section_ext_light_ambient">Lights have <tt>ambientIntensity</tt></a>
</li>
<li><a href="#section_ext_iv_in_vrml">Parts of Inventor in VRML</a>
</li>
<li><a href="#section_ext_multi_root_node">Multi root node</a>
</li>
<li><a href="#section_ext_wwwinline_separate">Field <tt>separate</tt> for <tt>WWWInline</tt> node</a>
</li>
<li><a href="#section_ext_cone_cyl_parts_none">Field <tt>parts</tt> in <tt>Cone</tt> and <tt>Cylinder</tt> nodes may have value <tt>NONE</tt></a>
</li>
</ol>
</div>
<h2><a name="section_ext_global">1. Lights can be global</a></h2>

  <p>All light source nodes have <tt>global</tt> field. The default value
  of it is <tt>FALSE</tt>, and it means to use standard VRML 1.0 light scope
  rules (light affects everything following, and is delimited by <tt>Separator</tt>).

  <p>You can change it to <tt>global</tt> = TRUE, and then the standard
  X3D global light behavior will be used: light will affect everything,
  regardless of light node placement in node graph. For developers:
  this also indicates that light shines on other 3D objects,
  outside of this scene, if you use <tt>TCastleSceneManager.GlobalLights := true;</tt>.
  Very useful to make your creatures, items and such lit by the level lights.

<h2><a name="section_ext_light_attenuation">2. Lights have <tt>attenuation</tt></a></h2>

    Lights that have a position, i.e. <tt>PointLight</tt> and <tt>SpotLight</tt>
    nodes, have the field <tt>attenuation</tt>. The meaning of this
    field is <a href="http://www.web3d.org/x3d/specifications/vrml/ISO-IEC-14772-VRML97/part1/nodesRef.html#PointLight">
    exactly the same as in VRML 97</a>.
    I allow this for VRML 1.0 because this is really useful,
    and because the default value of this field (1,0,0)
    assures that standard VRML 1.0 files are interpreted correctly.

<h2><a name="section_ext_light_ambient">3. Lights have <tt>ambientIntensity</tt></a></h2>

    <p>All lights have <tt>ambientIntensity</tt> field,
    also defined exactly like in VRML 97. However, when reading VRML 1.0
    files, we treat default value of <tt>ambientIntensity</tt>
    as -1 (while VRML 97 specification gives 0). And when rendering,
    we treat lights with <tt>ambientIntensity &lt; 0</tt> specially:
    we treat them like <tt>ambientIntensity</tt> = <tt>intensity</tt>.
    This way:
    <ol>
      <li>in VRML 1.0 when you specified <tt>ambientIntensity</tt>
        value, or in VRML 97: <tt>ambientIntensity</tt> is treated
        following VRML 97 specification. So rendered
        light ambient color is <tt>color</tt> * <tt>ambientIntensity</tt>.
      <li>in VRML 1.0 when you didn't specify <tt>ambientIntensity</tt>:
        calculations are compatible with standard VRML 1.0 behavior
        (although it was not really stated clearly in VRML 1.0 spec...).
        So rendered light ambient color is
        <tt>color</tt> * <tt>intensity</tt>.
    </ol>

<h2><a name="section_ext_iv_in_vrml">4. Parts of Inventor in VRML</a></h2>

    Some Inventor-specific things are allowed:
    <ul>
      <li><tt>ShapeHints</tt> node has <tt>hints</tt> field of type
        SFBitMask, allowed values are combinations of <tt>NONE</tt>,
        <tt>SOLID</tt>, <tt>ORDERED</tt> and <tt>CONVEX</tt>.
        This is allowed only if the file started with Inventor 1.0 signature
        (<tt>#Inventor V1.0 ascii</tt>).
      <li><tt>IndexedTriangleMesh</tt>, <tt>RotationXYZ</tt> nodes
        are allowed and understood
      <li>Some other fields from Inventor are allowed, but are actually ignored
    </ul>

    <p>These things allow me to handle many Inventor 1.0 files.
    They also allow me to handle many broken VRML 1.0
    files that sometimes falsely claim that they are VRML 1.0 while in
    fact they use some Inventor-specific features.

    <p>For completely unrecognized nodes, our engine can always omit them
    (even without any VRML &gt;= 2.0 (protos) or VRML 1.0 ("fields", "isA")
    extensibility features), so most Inventor files can be at least
    partially handled and displayed.

<h2><a name="section_ext_multi_root_node">5. Multi root node</a></h2>

    VRML 1.0 file may have any number of root nodes
    (VRML 1.0 spec requires that there is exactly one root node).
    I implemented this because
    <ol>
      <li>There are many invalid VRML 1.0 files on the Internet
        that use this extension (partially because it's
        normal VRML 97 feature, and many VRML viewers allow this)
      <li>This is allowed in VRML 97.
      <li>This was very easy to implement :)
    </ol>

<h2><a name="section_ext_wwwinline_separate">6. Field <tt>separate</tt> for <tt>WWWInline</tt> node</a></h2>

    I'm adding new field:
    <pre class="vrml_extension_spec"><b>WWWInline {</b>
  ... all normal WWWInline fields ...
  SFBool     [in,out]      <b>separate    TRUE      </b>
<b>}</b>
</pre>
    <p>To explain this field, let's create an example.
    Assume you have file <tt>1.wrl</tt> with following contents:

<pre class="vrml_code">
#VRML V1.0 ascii
Material { diffuseColor 1 0 0 }
</pre>

    And a file <tt>2.wrl</tt> with following contents:

<pre class="vrml_code">
#VRML V1.0 ascii
Group {
  WWWInline { name "1.wrl" }
  Cube { }
}
</pre>

    <p>Question: what material is used by the cube ? The red material
    (defined in <tt>1.wrl</tt>) or the default material ?
    In other words, do the state changes inside <tt>1.wrl</tt>
    "leak outside" of WWWInline node ?

    <p>The answer (stated by VRML specification, and followed by our
    programs when <tt>separate</tt> is TRUE (the default)) is that
    the cube uses the default material. <i>Not</i> the red material.
    In other words, state changes do not "leak" outside.
    This is definitely a sensible behavior. This is safer
    for the author of VRML files (you're not so "vulnerable" to changes
    done in included files). And it allows to delay
    loading of inlined file until it's really
    needed (e.g. is potentially visible). Effectively, this means
    that <tt>WWWInline</tt> behaves a little like a <tt>Separator</tt>
    node. File <tt>2.wrl</tt> is equivalent to

<pre class="vrml_code">
#VRML V1.0 ascii
Group {
  Separator {
    Material { diffuseColor 1 0 0 }
  }
  Cube { }
}
</pre>

    <p>On the other hand, when you set field <tt>separate</tt> to FALSE,
    the cube will be red. Every state change done inside inlined file
    will affect the things defined after <tt>WWWInline</tt> node.
    Effectively, this means that <tt>WWWInline</tt> behaves a little like a
    <tt>Group</tt> node. Two files below are equivalent:

<pre class="vrml_code">
#VRML V1.0 ascii
Group {
  WWWInline { name "1.wrl" separare FALSE }
  Cube { }
}
</pre>

<pre class="vrml_code">
#VRML V1.0 ascii
Group {
  Group {
    Material { diffuseColor 1 0 0 }
  }
  Cube { }
}
</pre>

    <p>Generally, setting field <tt>separate</tt> to FALSE
    is a little dangerous (because you have to be careful what
    you include), but it also allows you to do various tricks.

    <p>Test VRML file: see our <a href="demo_models.html">VRML/X3D demo models</a>, file
    <tt>vrml_1/castle_extensions/inline_not_separate.wrl</tt>.

<h2><a name="section_ext_cone_cyl_parts_none">7. Field <tt>parts</tt> in <tt>Cone</tt> and <tt>Cylinder</tt> nodes may have value <tt>NONE</tt></a></h2>

    This way every possible value is allowed for <tt>parts</tt>
    field. This is comfortable for operating on these nodes,
    especially from programs &mdash; there is no special "forbidden" value.

</td><td class="layout">
  <div class="sidebar">
    <div class="sidebar_title"><a href="vrml_x3d.html">VRML / X3D support</a></div><ul><li><a href="demo_models.html">Demo models</a></li><li><a href="x3d_extensions.html">Extensions</a><ul><li><a href="compositing_shaders.html">Compositing Shaders</a></li><li><a href="x3d_extensions_screen_effects.html">Screen Effects</a></li><li><a href="x3d_extensions_shadow_maps.html">Shadow Maps</a></li><li>(Old) VRML 1.0</li></ul></li><li><a href="x3d_implementation_status.html">X3D Components</a><ul><li><a href="x3d_implementation_core.html">Core</a></li><li><a href="x3d_implementation_time.html">Time</a></li><li><a href="x3d_implementation_networking.html">Networking</a></li><li><a href="x3d_implementation_grouping.html">Grouping</a></li><li><a href="x3d_implementation_rendering.html">Rendering</a></li><li><a href="x3d_implementation_shape.html">Shape</a></li><li><a href="x3d_implementation_geometry3d.html">Geometry3D</a></li><li><a href="x3d_implementation_geometry2d.html">Geometry2D</a></li><li><a href="x3d_implementation_text.html">Text</a><ul><li><a href="http://castle-engine.sourceforge.net/x3d_implementation_text_extensions.php">Extensions <i>(online docs)</i></a></li></ul></li><li><a href="x3d_implementation_sound.html">Sound</a></li><li><a href="x3d_implementation_lighting.html">Lighting</a></li><li><a href="x3d_implementation_texturing.html">Texturing</a><ul><li><a href="http://castle-engine.sourceforge.net/x3d_multi_texturing.php">X3D MultiTexturing problems and proposed solutions <i>(online docs)</i></a></li><li><a href="http://castle-engine.sourceforge.net/x3d_implementation_texturing_extensions.php">Extensions <i>(online docs)</i></a></li></ul></li><li><a href="x3d_implementation_interpolation.html">Interpolation</a><ul><li><a href="http://castle-engine.sourceforge.net/x3d_implementation_interpolation_extensions.php">Extensions <i>(online docs)</i></a></li></ul></li><li><a href="x3d_implementation_pointingdevicesensor.html">Pointing device sensor</a></li><li><a href="x3d_implementation_keydevicesensor.html">Key device sensor</a></li><li><a href="x3d_implementation_environmentalsensor.html">Environmental sensor</a></li><li><a href="x3d_implementation_navigation.html">Navigation</a><ul><li><a href="http://castle-engine.sourceforge.net/x3d_implementation_navigation_extensions.php">Extensions <i>(online docs)</i></a></li></ul></li><li><a href="x3d_implementation_environmentaleffects.html">Environmental effects</a></li><li><a href="x3d_implementation_hanim.html">H-Anim</a></li><li><a href="x3d_implementation_nurbs.html">NURBS</a><ul><li><a href="x3d_implementation_nurbs.html#section_homogeneous_coordinates">Control points are in homogeneous coordinates</a></li></ul></li><li><a href="x3d_implementation_scripting.html">Scripting</a></li><li><a href="x3d_implementation_eventutilities.html">Event utilities</a><ul><li><a href="http://castle-engine.sourceforge.net/x3d_implementation_eventutilities_extensions.php">Extensions <i>(online docs)</i></a></li></ul></li><li><a href="x3d_implementation_shaders.html">Programmable shaders</a></li><li><a href="x3d_implementation_cadgeometry.html">CAD geometry</a></li><li><a href="x3d_implementation_texturing3d.html">Texturing3D</a></li><li><a href="x3d_implementation_cubemaptexturing.html">Cube map environmental texturing</a></li></ul></li><li><a href="nist_vrml_test_suite.html">NIST conformace test suite</a></li><li><a href="castle_script.html">CastleScript language reference</a></li><li><a href="kanim_format.html">Kanim (precalculated animations) file format</a></li><li><a href="x3d_time_origin_considered_uncomfortable.html">VRML / X3D time origin considered uncomfortable</a></li></ul></div></td></tr></table><script type="text/javascript">
  jQuery('a.screenshot').colorbox({opacity: 0.9, rel:'screenshot', maxWidth:'90%', maxHeight:'90%'});
</script>
  
<hr>

<div class="page_footer">

    <address>
    By Michalis Kamburelis, as part of
    <a href="http://castle-engine.sourceforge.net/">Castle Game Engine</a>.
    </address>
    
  <table class="footer-table"><tr>

    <td><a href="http://sourceforge.net/projects/castle-engine">Hosted by SourceForge.net</a></td>

    <td><span class="page_copyright">Copyright <a href="http://michalis.ii.uni.wroc.pl/~michalis/">Michalis Kamburelis</a>.
This page is considered part of documentation of my programs,
and you are free to modify and further distribute it on terms of
<a href="http://www.gnu.org/licenses/gpl.html">GNU General Public License</a>.
</span><br/>
      <small>We use <a href="http://en.wikipedia.org/wiki/HTTP_cookie">cookies</a>.
      Like every other frickin' website on the Internet.
      Blink twice if you understand.</small>
    </td>

    
  </tr></table>



  
</div>

</body>
</html>

